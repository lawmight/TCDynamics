{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "shell",
      "label": "func: host start",
      "command": "func host start",
      "problemMatcher": [],
      "isBackground": true,
      "dependsOn": "pip install (functions)",
      "options": {
        "cwd": "${workspaceFolder}/TCDynamics"
      }
    },
    {
      "type": "shell",
      "label": "func: host start (debug)",
      "command": "func host start",
      "args": [
        "--language-worker",
        "--workerId",
        "python",
        "--requestId",
        "debug",
        "--debug"
      ],
      "env": {
        "languageWorkers__python__arguments": "--debug"
      },
      "problemMatcher": [],
      "isBackground": true,
      "dependsOn": "pip install (functions)",
      "options": {
        "cwd": "${workspaceFolder}/TCDynamics"
      }
    },
    {
      "label": "pip install (functions)",
      "type": "shell",
      "osx": {
        "command": "${config:azureFunctions.pythonVenv}/bin/python -m pip install -r requirements.txt"
      },
      "windows": {
        "command": "${config:azureFunctions.pythonVenv}\\Scripts\\python -m pip install -r requirements.txt"
      },
      "linux": {
        "command": "${config:azureFunctions.pythonVenv}/bin/python -m pip install -r requirements.txt"
      },
      "problemMatcher": [],
      "options": {
        "cwd": "${workspaceFolder}/TCDynamics"
      }
    },
    {
      "label": "Deploy to Azure Functions",
      "type": "shell",
      "command": "func azure functionapp publish func-tcdynamics-contact",
      "problemMatcher": [],
      "dependsOn": "pip install (functions)",
      "options": {
        "cwd": "${workspaceFolder}/TCDynamics"
      },
      "group": {
        "kind": "build",
        "isDefault": false
      }
    },
    {
      "label": "Frontend: Install Dependencies",
      "type": "shell",
      "command": "npm install",
      "group": "build",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": []
    },
    {
      "label": "Frontend: Start Development Server",
      "type": "shell",
      "command": "npm run dev",
      "group": "build",
      "isBackground": true,
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*)\\s\\((\\d+):(\\d+)\\)$",
          "file": 1,
          "line": 2,
          "column": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*VITE.*",
          "endsPattern": ".*Local:.*http://localhost:\\d+.*"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false
      }
    },
    {
      "label": "Frontend: Build for Production",
      "type": "shell",
      "command": "npm run build",
      "group": "build",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": "$tsc"
    },
    {
      "label": "Frontend: Run Tests (Vitest)",
      "type": "shell",
      "command": "npm test",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": []
    },
    {
      "label": "Frontend: Run Tests with UI",
      "type": "shell",
      "command": "npm run test:ui",
      "group": "test",
      "isBackground": true,
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": []
    },
    {
      "label": "Frontend: Run E2E Tests (Playwright)",
      "type": "shell",
      "command": "npm run test:e2e",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": []
    },
    {
      "label": "Frontend: Lint Code",
      "type": "shell",
      "command": "npm run lint",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": "$eslint-stylish"
    },
    {
      "label": "Frontend: Type Check",
      "type": "shell",
      "command": "npm run type-check",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": "$tsc"
    },
    {
      "label": "Backend: Install Dependencies",
      "type": "shell",
      "command": "npm install",
      "group": "build",
      "options": {
        "cwd": "${workspaceFolder}/apps/backend"
      },
      "problemMatcher": []
    },
    {
      "label": "Backend: Start Development Server",
      "type": "shell",
      "command": "npm run dev",
      "group": "build",
      "isBackground": true,
      "options": {
        "cwd": "${workspaceFolder}/apps/backend"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*)\\s\\((\\d+):(\\d+)\\)$",
          "file": 1,
          "line": 2,
          "column": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*Server.*",
          "endsPattern": ".*listening.*"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false
      }
    },
    {
      "label": "Backend: Build TypeScript",
      "type": "shell",
      "command": "npm run build",
      "group": "build",
      "options": {
        "cwd": "${workspaceFolder}/apps/backend"
      },
      "problemMatcher": "$tsc"
    },
    {
      "label": "Backend: Run Tests",
      "type": "shell",
      "command": "npm test",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/backend"
      },
      "problemMatcher": []
    },
    {
      "label": "Backend: Lint Code",
      "type": "shell",
      "command": "npm run lint",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/backend"
      },
      "problemMatcher": "$eslint-stylish"
    },
    {
      "label": "Backend: Type Check",
      "type": "shell",
      "command": "npm run type-check",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/backend"
      },
      "problemMatcher": "$tsc"
    },
    {
      "label": "Docker: Compose Up",
      "type": "shell",
      "command": "docker compose up -d",
      "group": "build",
      "options": {
        "cwd": "${workspaceFolder}/docker"
      },
      "problemMatcher": [],
      "_comment": "Requires Docker CLI with Compose V2 plugin (docker compose, not docker-compose)"
    },
    {
      "label": "Docker: Compose Down",
      "type": "shell",
      "command": "docker compose down",
      "group": "build",
      "options": {
        "cwd": "${workspaceFolder}/docker"
      },
      "problemMatcher": [],
      "_comment": "Requires Docker CLI with Compose V2 plugin (docker compose, not docker-compose)"
    },
    {
      "label": "MCP: Start NIA Server",
      "type": "shell",
      "command": "cursor-mcp",
      "group": "build",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "Pre-push: Run Checks",
      "type": "shell",
      "command": "npm run pre-push-checks",
      "group": "test",
      "options": {
        "cwd": "${workspaceFolder}/apps/frontend"
      },
      "problemMatcher": []
    },
    {
      "label": "Full Development Setup",
      "dependsOrder": "parallel",
      "dependsOn": [
        "Frontend: Install Dependencies",
        "Backend: Install Dependencies",
        "pip install (functions)"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "label": "Start Full Stack Dev",
      "dependsOrder": "parallel",
      "dependsOn": [
        "Frontend: Start Development Server",
        "Backend: Start Development Server"
      ],
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    }
  ]
}
